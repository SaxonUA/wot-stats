<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Врятувати Раяна</title>
  <style>
    body {
      margin: 0;
      font-family: 'Arial Black', sans-serif;
      background: url('https://cdn.jsdelivr.net/gh/SaxonUA/wot-stats/assets/ryan_bg_clean.png') no-repeat center center;
      background-size: cover;
      color: #f4f1dc;
      text-shadow: 2px 2px 4px #000;
    }
    .wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 5vh;
    }
    .title {
      font-size: 3vw;
      text-transform: uppercase;
      text-align: center;
      line-height: 1.1;
      margin-bottom: 3vh;
    }
    .row {
      display: flex;
      justify-content: center;
      gap: 5vw;
      margin-bottom: 2vh;
    }
    .stat {
      text-align: center;
      font-size: 2vw;
    }
    .number {
      font-size: 2.5vw;
      color: #ffe;
    }
    .highlight {
      font-size: 2vw;
      margin: 3vh 0;
    }
    .highlight .number {
      font-size: 4vw;
      color: #fffacc;
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <div class="title">
      ВРЯТУВАТИ<br>
      РЯДОВОГО<br>
      РАЯНА
    </div>

    <div class="row">
      <div class="stat">
        <div>ВРЯТОВАНО</div>
        <div class="number" id="saved">-</div>
      </div>
      <div class="stat">
        <div>НЕ ВРЯТОВАНО</div>
        <div class="number" id="notSaved">-</div>
      </div>
    </div>

    <!-- Виділений блок -->
    <div class="stat highlight">
      <div>К-ть золота до розіграшу</div>
      <div class="number" id="gold">-</div>
    </div>

    <div class="stat">
      <div>К-ть боїв</div>
      <div class="number" id="battles">-</div>
    </div>
  </div>

  <script>
    const SHEET_ID = "17phnEn-NW-OnrZg4DcW65r-Xoq6ScsdVjS5yL0SS3fk";
    const SHEET_NAME = "VRR";
    const RANGE = "I2:L2";

    async function fetchData() {
      const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${SHEET_NAME}&range=${RANGE}`;
      try {
        const res = await fetch(url);
        const text = await res.text();
        const json = JSON.parse(text.substr(47).slice(0, -2));
        const row = json.table.rows[0].c.map(cell => cell ? cell.v : "-");

        document.getElementById("battles").textContent = row[0];
        document.getElementById("gold").textContent = row[1];
        document.getElementById("saved").textContent = row[2];
        document.getElementById("notSaved").textContent = row[3];
      } catch (e) {
        console.error("Помилка завантаження даних:", e);
      }
    }

    fetchData();
    setInterval(fetchData, 15000);
  </script>
</body>
</html>
